<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>
<HEAD>
	<!-- $Header$ -->
	<META NAME="Description" CONTENT="iText is a JAVA library that can be used to generate complex PDF documents (with images, tables,...).">
	<META NAME="Keywords" CONTENT="PDF, JAVA, servlets, iText, Tutorial, generate, internet, documents, Lowagie, Bruno">
	<TITLE>iText - Tutorial</TITLE>
        <style>
                div.sectionHeader { font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:12pt; color: #008080; margin-bottom: 5px;}
                div.subHeader { font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size: 10pt; margin-top: 5px;}
                div.textArea { font-family: Arial, Helvetica, sans-serif; font-size:10pt; margin-bottom: 30px; }
                span.code { font-family: Courier, monospace; }
                div.codeBlock { font-family: Courier, monospace; font-size: 10pt; padding-top: 5px; padding-bottom: 5px; padding-left: 15px; padding-right: 15px; }
                table { font-family: inherit; font-size: inherit; }
                th { font-family: inherit; font-size: inherit; }
                td { font-family: inherit; font-size: inherit; }
        </style>
</HEAD>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#008080" VLINK="#008080" ALINK="#00CCCC">

<A NAME="top"></A>

<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="5" ALIGN="center" BGCOLOR="#808080">
<TR>
	<TD>
	<TABLE WIDTH="100%" BORDER="0" CELLSPACING="0" CELLPADDING="7" BGCOLOR="#008080">
	<TR>
		<TD COLSPAN="2" ALIGN="center">
			<FONT FACE="Times New Roman" SIZE="+3" COLOR="#FFFFFF"><I>i</I></FONT><FONT FACE="Arial,Helvetica" SIZE="+3" COLOR="#FFFFFF">Text Tutorial</FONT>
		</TD>
		<TD BGCOLOR="#808080">
			<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=15255&type=2" width="125" height="37" border="0" alt="SourceForge.net Logo"></a>
		</TD>
		<TD COLSPAN="2" BGCOLOR="#808080">
			<FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">iText, a Free Java-PDF library<BR>
			by </FONT><A HREF="http://www.lowagie.com/"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Bruno Lowagie</FONT></A><BR>
		</TD>
	</TR>
	<TR>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="http://www.lowagie.com/iText/"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Home</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="ch07.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Previous</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="index.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">TOC</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="ch09.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Next</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="notyet.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">PDF</FONT></A>]</FONT></TD>
	</TR>
	<TR>
		<TD COLSPAN="5" BGCOLOR="#FFFFFF">
			<BR>
			<FONT FACE="Arial,Helvetica" SIZE="+1">Part II: Other document formats</FONT><BR><BR>
			<FONT FACE="Arial,Helvetica"><B>Chapter 8: RTF</B></FONT><BR>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN="5" BGCOLOR="#FFFFFF">
                        <div class="sectionHeader"><a name="rtfpackage"></a>The RTF package</div>
                        <div class="textArea">
                          The RTF package is an extension of the iText package and allows iText to output Rich Text files in addition to PDF files. The majority of the iText features for PDF generation are also supported by the RTF package, with a few <a href="ch08.html#unsupported">exceptions</a>. There are currently two classes you can use to generate RTF documents in the RTF package. The new <span class="code">RtfWriter2</span> class and the old <span class="code">RtfWriter</span> class. For details please read <a href="ch08.html#rtfdocument">Creating a RTF document</a>.<br /><br />
                          Additionally the RTF package contains a few features, that are RTF specific:
                          <ul>
                            <li><a href="ch08.html#extendedfont">Extended font support</a></li>
                            <li><a href="ch08.html#extendedhf">Extended header / footer support</a></li>
                            <li><a href="ch08.html#tocsupport">Table of contents support</a></li>
                            <li><a href="ch08.html#extenedcellborder">Extended cell border support</a></li>
                            <li><a href="ch08.html#pagenumberelement">Page number element</a></li>
                            <li><a href="ch08.html#examplelist">List of examples</a></li>
                          </ul>
                        </div>
                        <div class="sectionHeader"><a name="rtfdocument"></a>Creating a RTF document</div>
                        <div class="textArea">
                          There is no difference between generating a PDF document and a RTF document with iText.
                          <div class="codeBlock">
                            Document document = new Document();<br />
                            RtfWriter2.getInstance(document, new FileOutputStream("testRTFdocument.rtf"));<br />
                            document.open();<br />
                            document.add(new Paragraph("Hello World!"));<br />
                            document.close();
                          </div>
                          <a href="../examples/Chap0801.java">Full example source code</a>.<br /><br />
                          <div class="subHeader">RtfWriter2 and RtfWriter. Which one to use?</div>
                          Short version: If you are starting a new project using the RTF package, use the new <span class="code">RtfWriter2</span>.<br /><br />
                          The new <span class="code">RtfWriter2</span> replaces the old <span class="code">RtfWriter</span>. To allow for a cleaner design and structure, the new <span class="code">RtfWriter2</span> shares no code with the old version. This means that the old extensions to the <span class="code">RtfWriter</span> will not work with the new version. So as not to force anybody to upgrade their programs and still to allow everybody to incorporate bug fixes, the two writers exist in parallel.<br />
                          For those who are starting a new project with iText and the RTF package, this has no consequences. They should use the new <span class="code">RtfWriter2</span>, because this is where future development will happen.<br />
                          For those who have already got a working program, but don't use any of the old RTF specific classes, they can simply change the writer to the new <span class="code">RtfWriter2</span>.<br />
                          For those who are using the old RTF specific classes the following table shows which new classes to use when upgrading.
                          <table>
                            <tr>
                              <th>Old extensions</th>
                              <th>New extensions</th>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.RtfFont</span></td>
                              <td><span class="code">com.lowagie.text.rtf.style.RtfFont</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowgaie.text.rtf.HeaderFooter</span></td>
                              <td><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.HeaderFooters</span></td>
                              <td><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooterGroup</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.RtfPageNumber</span></td>
                              <td><span class="code">com.lowagie.text.rtf.field.RtfPageNumber</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.RtfTOC</span></td>
                              <td><span class="code">com.lowagie.text.rtf.field.RtfTableOfContents</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.RtfTOCEntry</span></td>
                              <td><span class="code">com.lowagie.text.rtf.field.RtfTOCEntry</span></td>
                            </tr>
                            <tr>
                              <td><span class="code">com.lowagie.text.rtf.RtfTableCell</span></td>
                              <td><span class="code">com.lowagie.text.rtf.table.RtfCell</span></td>
                            </tr>
                          </table>
                          Some of the new extensions have to be used in a slightly different manner now, but all functionality that was present in the old extensions is also available in the new extensions.<br /><br />
                          The old <span class="code">RtfWriter</span> will continue to exist in its current form until the end of 2005 when it will be deprecated. It will finally be removed at the end of 2007. The same goes for all extensions of the old <span class="code">RtfWriter</span>.
                        </div>
                        <div class="sectionHeader"><a name="unsupported"></a>Unsupported iText features</div>
                        <div class="textArea">
                          <ul>
                            <li>Watermarks</li>
                            <li>Viewer preferences</li>
                            <li>Encryption</li>
                            <li>Embedded fonts</li>
                            <li>Phrases with a leading</li>
                            <li>Lists with non-bullet symbols</li>
                            <li>Nested tables</li>
                            <li>Images other than JPEG, PNG, BMP and WMF</li>
                            <li>Rotated images</li>
                          </ul>
                        </div>
                        <div class="sectionHeader"><a name="extendedfont"></a>Extended font support</div>
                        <div class="textArea">
                          The base RTF package does not support embedding fonts (see <a href="ch08.html#unsupported">unsupported iText features</a>). To allow the RTF package to produce RTF documents with more than the built in fonts, the <span class="code">RtfFont</span> class provides the facility to specify arbitrary fonts.
                          <div class="codeBlock">
                            RtfFont rtfFont = new RtfFont("Comic Sans MS");<br />
                            Paragraph para = new Paragraph("This is a paragraph in Comic Sans MS", rtfFont);<br />
                            document.add(para);
                          </div>
                          For this to work, the correct font must be installed on the machine that is used to view the RTF document, not on the machine that creates the document. Also the given font name must match the name of the font on the viewer machine exactely.<br /><br />
                          <a href="../examples/Chap0802.java">Full example source code</a>.
                        </div>
                        <div class="sectionHeader"><a name="extendedhf"></a>Extended header / footer support</div>
                        <div class="textArea">
                          One of the limitations of the RTF format is that only one header and footer is allowed per section. There are two ways to overcome this limitation. It is possible to
                          <ul>
                            <li>use multiple Chapters. Every Chapter can have different headers and footers.</li>
                            <li>use the RtfHeaderFooterGroup to have up to 3 different headers or footers per document or Chapter.</li>
                          </ul>
                          <div class="subHeader">Using multiple Chapters</div>
                          The first solution is very simple. Before adding the Chapter to the document, you set the headers and footers that you want to have in that Chapter.
                          <div class="codeBlock">
                            HeaderFooter header1 = new HeaderFooter("This is the first chapter", false);<br />
                            HeaderFooter header2 = new HeaderFooter("This is page", ".");<br />
                            Chapter chapter1 = new Chapter(new Paragraph("This is the first Chapter"), 1);<br />
                            Chapter chapter2 = new Chapter(new Paragraph("Chapter 2"), 2);<br />
                            document.setHeader(header1);<br />
                            document.add(chapter1);<br />
                            document.setHeader(header2);<br />
                            document.add(chapter2);
                          </div>
                          <div class="subHeader">Using the RtfHeaderFooterGroup</div>
                          The second solution is to use the <span class="code">RtfHeaderFooterGroup</span>. This is slightly more complex. You will have to create a <span class="code">RtfHeaderFooterGroup</span> object and then add the <span class="code">HeaderFooter</span> objects to the <span class="code">RtfHeaderFooterGroup</span> specifying on which pages the headers / footers should appear. The following positions are supported:
                          <ul>
                            <li><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_FIRST_PAGE</span></li>
                            <li><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_ALL_PAGES</span></li>
                            <li><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_LEFT_PAGES</span></li>
                            <li><span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_RIGHT_PAGES</span></li>
                          </ul>
                          DISPLAY_ALL_PAGES and DISPLAY_LEFT_PAGES/DISPLAY_RIGHT_PAGES cannot be combined, otherwise all combinations are possible.<br /><br />
                          The first step is to create a RtfHeaderFooterGroup and then you add the HeaderFooter objects and specify where they are to appear.
                          <div class="codeBlock">
			    RtfHeaderFooterGroup footer = new RtfHeaderFooterGroup();<br />
			    footer.setHeaderFooter(new RtfHeaderFooter(new Phrase("This is the footer on the title page")), com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_FIRST_PAGE);<br />
			    footer.setHeaderFooter(new RtfHeaderFooter(new Phrase("This is a left side page")), com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_LEFT_PAGES);<br />
			    footer.setHeaderFooter(new RtfHeaderFooter(new Phrase("This is a right side page")), com.lowagie.text.rtf.headerfooter.RtfHeaderFooter.DISPLAY_RIGHT_PAGES);<br />
			    document.setFooter(footer);
                          </div>
                          <div class="subHeader">Arbitrary Elements in the header</div>
                          To give the <span class="code">RtfWriter2</span> more flexibility when creating headers or footers, the <span class="code">com.lowagie.text.rtf.headerfooter.RtfHeaderFooter</span> makes it possible to add any <span class="code">Element</span> as a header or footer. This can be used to add tables to the header, giving improved formating capabilities.
                          <div class="codeBlock">
			    Table headerTable = new Table(3);<br />
			    headerTable.addCell("Document header");<br />
			    Cell pageNumberCell = new Cell();<br />
			    pageNumberCell.add(new RtfPageNumber());<br />
			    headerTable.addCell(pageNumberCell);<br />
			    headerTable.addCell("Company Name");<br />
			    HeaderFooter header = new RtfHeaderFooter(headerTable);<br />
			    document.setHeader(header);
                          </div>
                          <a href="../examples/Chap0803.java">Full example source code</a>.
                        </div>
                        <div class="sectionHeader"><a name="tocsupport"></a>Table of contents support</div>
                        <div class="textArea">
                          The <span class="code">RtfWriter2</span> also supports the creation of a table of contents and the addition of entries into that table of contents. There is one limitation and that is that the actual table of contents will have to be generated by the RTF viewer application, because iText does not know how to render RTF documents and can therefore not calculate the correct page numbers. When creating the <span class="code">RtfTableOfContents</span> it is necessary to specify the text that is displayed before the field is updated by the viewer.
                          <div class="subHeader">Adding a table of contents</div>
                          You can add the actual table of contents anywhere in the document. Simply create an instance of <span class="code">com.lowagie.text.rtf.toc.RtfTableOfContents</span> and add it to a paragraph. The constructor takes the default string to display and the font to use as parameters.
                          <div class="codeBlock">
                            Paragraph para = new Paragraph();<br />
                            para.add(new RtfTableOfContents("RIGHT CLICK AND HERE AND SELECT \"UPDATE FIELD\" TO UPDATE.", new Font()));<br />
                            doc.add(para);
                          </div>
                          <div class="subHeader">Adding entries to the table of contents</div>
                          You can add entries to the table of contents before or after you've added the actual table of contents. It's as simple as adding an instance of RtfTOCEntry to the document.
			  <div class="codeBlock">
			    RtfTOCEntry tocEntry = new RtfTOCEntry("Manually added TOC entry", new Font());<br />
			    document.add(tocEntry);
			  </div>
			  The second possibility is to let the <span class="code">RtfWriter2</span> automatically add <span class="code">RtfTOCEntry</span>s for every Chapter you add.
			  <div class="codeBlock">
			    document.setAutogenerateTOCEntries(true);
			  </div>
                          <a href="../examples/Chap0804.java">Full example source code</a>.
                        </div>
                        <div class="sectionHeader"><a name="extendedcellborder"></a>Extended cell border support</div>
			<div class="textArea">
			  The <span class="code">RtfWriter2</span> also provides support for using special border styles with table cells. To use this feature you add <span class="code">RtfCell</span> objects to the <span class="code">Table</span> instead of <span class="code">Cell</span>s.
                          <div class="codeBlock">
			    RtfCell cellDotted = new RtfCell("Dotted border");<br />
			    cellDotted.setBorders(new RtfBorderGroup(Rectangle.BOX, RtfBorder.BORDER_DOTTED, 1, new Color(0, 0, 0)));<br />
			    RtfCell cellEmbossed = new RtfCell("Embossed border");<br />
			    cellEmbossed.setBorders(new RtfBorderGroup(Rectangle.BOX, RtfBorder.BORDER_EMBOSS, 1, new Color(0, 0, 0)));<br />
			    RtfCell cellNoBorder = new RtfCell("No border");<br />
			    cellNoBorder.setBorders(new RtfBorderGroup());<br /><br />
			  
			    table.addCell(cellDotted);<br />
			    table.addCell(cellEmbossed);<br />
			    table.addCell(cellNoBorder);
			  </div>
			  The RtfCell supports a long list of border styles. Please consult the javadoc documentation for an exhaustive list.<br />
                          <a href="../examples/Chap0804.java">Full example source code</a>.
                        </div>
                        <div class="sectionHeader"><a name="pagenumberelement"></a>Page number element</div>
			<div class="textArea">
			  The <span class="code">RtfPageNumber</span> class allows you to add the number of the current page at any position in the document. The primary use is in headers or footers with special formatting.
                          <div class="codeBlock">
			    Table headerTable = new Table(3);<br />
			    headerTable.addCell("Document header");<br />
			    Cell pageNumberCell = new Cell();<br />
			    pageNumberCell.add(new RtfPageNumber());<br />
			    headerTable.addCell(pageNumberCell);<br />
			    headerTable.addCell("Company Name");<br />
			    HeaderFooter header = new RtfHeaderFooter(headerTable);<br />
			    document.setHeader(header);
                          </div>
                          <a href="../examples/Chap0803.java">Full example source code</a>.
			</div>
			<div class="sectionHeader"><a name="examplelist"></a>List of examples</div>
			<div class="textArea">
			  <ul>
			    <li><a href="../examples/Chap0801.java">Generating a RTF document</a></li>
			    <li><a href="../examples/Chap0802.java">Special fonts</a></li>
			    <li><a href="../examples/Chap0803.java">Headers/footers and page numbers</a></li>
			    <li><a href="../examples/Chap0804.java">Table of contents and cell borders</a></li>
			    <li><a href="../examples/Chap0805.java">The TestSuite used to test RtfWriter2 functionality</a></li>
			  </ul>
			</div>
		</TD>
	</TR>
	<TR>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="#top"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Top</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="ch07.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Previous</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="index.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">TOC</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="ch09.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">Next</FONT></A>]</FONT></TD>
		<TD WIDTH="20%" ALIGN="center"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF" SIZE="-1">[<A HREF="notyet.html"><FONT FACE="Arial,Helvetica" COLOR="#FFFFFF">PDF</FONT></A>]</FONT></TD>
	</TR>
	<TR>
		<TD COLSPAN="2" ALIGN="left" VALIGN="top" BGCOLOR="#808080">
			<FONT FACE="Arial,Helvetica" SIZE="-3">
			<B>Page Updated: </B> $Date$<br>
			Copyright &copy; 2000, 2001 by Bruno Lowagie, 2004 Mark Hall
			</FONT>
		</TD>
		<TD COLSPAN="3" ALIGN="right" BGCOLOR="#808080">
			<FONT FACE="Arial,Helvetica" SIZE="-3">
			Adolf Baeyensstraat 121, 9040 Gent, BELGIUM,<br>
			tel +00 32 92 28 10 97 mailto:<A HREF="mailto:itext-questions@lists.sourceforge.net"><FONT COLOR="#000000">itext-questions@lists.sourceforge.net</FONT></A>
			</FONT>
		</TD>
	</TR>
	</TABLE>
	</TD>
</TABLE>

</BODY>
</HTML>
